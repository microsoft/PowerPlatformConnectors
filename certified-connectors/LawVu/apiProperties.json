{
  "properties": {
    "connectionParameters": {
      "token:customHost": {
        "type": "string",
        "uiDefinition": {
          "constraints": {
            "required": "true",
            "tabIndex": 3,
            "allowedValues": [
              {
                "text": "Default",
                "value": "au.public-api.lawvu.com"
              }
            ]
          },
          "displayName": "Version",
          "description": "Select default to continue"
        }
      },
      "token": {
        "type": "oauthSetting",
        "oAuthSettings": {
          "identityProvider": "oauth2",
          "clientId": "power-platform-integration",
          "scopes": [],
          "redirectMode": "Global",
          "customParameters": {
            "authorizationUrl": {
              "value": "https://go.lawvu.com/#/authorize"
            },
            "tokenUrl": {
              "value": "https://au.public-api.lawvu.com/account-apis/v1/auth/token"
            },
            "refreshUrl": {
              "value": "https://au.public-api.lawvu.com/account-apis/v1/auth/token"
            }
          }
        },
        "uiDefinition": {
          "displayName": "Login to LawVu",
          "description": "Login to LawVu",
          "tooltip": "Login to LawVu",
          "constraints": {
            "required": "true"
          }
        }
      }
    },
    "connectionParameterSets": {
      "uiDefinition": {
        "displayName": "LawVu Region",
        "description": "Select the LawVu region your organization uses. If you are unsure, check with your LawVu administrator"
      },
      "values": [
        {
          "name": "oauthAU",
          "uiDefinition": {
            "displayName": "Australia",
            "description": "Australia"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "au.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://go.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://au.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://au.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthCAN",
          "uiDefinition": {
            "displayName": "Canada",
            "description": "Canada"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "can.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://can.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://can.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://can.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthEU",
          "uiDefinition": {
            "displayName": "Europe",
            "description": "Europe"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "eu.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://eu.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://eu.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://eu.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthUS",
          "uiDefinition": {
            "displayName": "United States",
            "description": "United States"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "us.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://us.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://us.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://us.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthDemo",
          "uiDefinition": {
            "displayName": "Demo",
            "description": "Demo"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "demo.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://demo.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://demo.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://demo.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthIntegrations",
          "uiDefinition": {
            "displayName": "Integrations",
            "description": "Integrations"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3,
                  "allowedValues": [
                    {
                      "text": "Default",
                      "value": "integrations.public-api.lawvu.com"
                    }
                  ]
                },
                "displayName": "Version",
                "description": "Select default to continue"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "customParameters": {
                  "authorizationUrl": {
                    "value": "https://integrations.lawvu.com/#/authorize"
                  },
                  "tokenUrl": {
                    "value": "https://integrations.public-api.lawvu.com/account-apis/v1/auth/token"
                  },
                  "refreshUrl": {
                    "value": "https://integrations.public-api.lawvu.com/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        },
        {
          "name": "oauthCustom",
          "uiDefinition": {
            "displayName": "Custom",
            "description": "Custom"
          },
          "metadata": {
            "allowSharing": false
          },
          "parameters": {
            "token:customAuth": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 2
                },
                "displayName": "LawVu Authorization Host Address"
              }
            },
            "token:customHost": {
              "type": "string",
              "uiDefinition": {
                "constraints": {
                  "required": "true",
                  "tabIndex": 3
                },
                "displayName": "LawVu Public API Host Address"
              }
            },
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "oauth2generic",
                "clientId": "power-platform-integration",
                "scopes": [],
                "redirectMode": "Global",
                "redirectUrl": "https://global.consent.azure-apim.net/redirect",
                "customParameters": {
                  "authorizationUrlTemplate": {
                    "value": "https://{customAuth}/#/authorize"
                  },
                  "tokenUrlTemplate": {
                    "value": "https://{customHost}/account-apis/v1/auth/token"
                  },
                  "refreshUrlTemplate": {
                    "value": "https://{customHost}/account-apis/v1/auth/token"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Login to LawVu",
                "description": "Login to LawVu",
                "tooltip": "Login to LawVu",
                "constraints": {
                  "required": "true"
                }
              }
            }
          }
        }
      ]
    },
    "iconBrandColor": "#3B0839",
    "capabilities": [],
    "policyTemplateInstances": [
      {
        "templateId": "dynamichosturl",
        "title": "Set host for connection",
        "parameters": {
          "x-ms-apimTemplateParameter.urlTemplate": "https://@connectionParameters('token:customHost')"
        }
      },
      {
        "templateId": "routerequesttoendpoint",
        "title": "Route Triggers to Webhooks",
        "parameters": {
          "x-ms-apimTemplateParameter.newPath": "/account-apis/v1/webhooks/subscriptions",
          "x-ms-apimTemplateParameter.httpMethod": "@Request.OriginalHTTPMethod",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterCreated",
            "Triggers_CreateSubscriptionMatterUpdated",
            "Triggers_CreateSubscriptionMatterStatusUpdated",
            "Triggers_CreateSubscriptionContractStatusUpdated",
            "Triggers_CreateSubscriptionContractCreated",
            "Triggers_CreateSubscriptionContractUpdated",
            "Triggers_CreateSubscriptionMatterFileCreatedOrUpdated",
            "Triggers_CreateSubscriptionContractFileCreatedOrUpdated",
            "Triggers_CreateSubscriptionContractDocumentUpdated",
            "Triggers_CreateSubscriptionMatterTagCreated",
            "Triggers_CreateSubscriptionMatterStatusMessageCreated",
            "Triggers_CreateSubscriptionContractStatusMessageCreated",
            "Triggers_CreateSubscriptionContractKeyDateCreated",
            "Triggers_CreateSubscriptionContractKeyDateUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterStatusUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.status.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterStatusUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractStatusUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.status.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractStatusUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterFileCreatedOrUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.file.created\", \"matter.file.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterFileCreatedOrUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractFileCreatedOrUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.file.created\", \"contract.file.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractFileCreatedOrUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractDocumentUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.document.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractDocumentUpdated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterTagCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.tag.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterTagCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - MatterStatusMessageCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"matter.statusmessage.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionMatterStatusMessageCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractStatusMessageCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.statusmessage.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractStatusMessageCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractKeyDateCreated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.keydate.created\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractKeyDateCreated"
          ]
        }
      },
      {
        "templateId": "setproperty",
        "title": "Triggers - Topics - ContractKeyDateUpdated",
        "parameters": {
          "x-ms-apimTemplateParameter.newPropertyParentPathTemplate": "@body()",
          "x-ms-apimTemplateParameter.newPropertySubPathTemplate": "topics",
          "x-ms-apimTemplateParameter.propertyValuePathTemplate": "[\"contract.keydate.updated\"]",
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplate-operationName": [
            "Triggers_CreateSubscriptionContractKeyDateUpdated"
          ]
        }
      },
      {
        "parameters": {
          "x-ms-apimTemplate-policySection": "Request",
          "x-ms-apimTemplateParameter.existsAction": "override",
          "x-ms-apimTemplateParameter.name": "LawVuPowerPlatformConnector-Version",
          "x-ms-apimTemplateParameter.value": "324.0"
        },
        "templateId": "setheader",
        "title": "Set LawVu Power Platform Version Header"
      }
    ],
    "publisher": "LawVu Ltd",
    "stackOwner": "LawVu Ltd"
  }
}