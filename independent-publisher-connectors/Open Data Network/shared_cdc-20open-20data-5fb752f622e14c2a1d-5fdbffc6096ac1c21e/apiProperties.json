{
  "properties": {
    "connectionParameters": {
      "auth_type": {
        "type": "string",
        "uiDefinition": {
          "displayName": "Authentication Type",
          "description": "Select the authentication type to use",
          "tooltip": "Select the authentication type to use",
          "constraints": {
            "tabIndex": 1,
            "required": "true",
            "allowedValues": [
              {
                "value": "api_key",
                "text": "API Key"
              },
              {
                "value": "basic",
                "text": "Basic Auth"
              }
            ]
          }
        }
      },
      "api_key": {
        "type": "securestring",
        "uiDefinition": {
          "displayName": "App Token",
          "description": "The App Token for this API",
          "tooltip": "Provide your App Token",
          "constraints": {
            "tabIndex": 2,
            "clearText": false,
            "required": "false"
          },
          "dependsOn": [
            {
              "parameter": "auth_type",
              "value": "api_key"
            }
          ]
        }
      },
      "username": {
        "type": "string",
        "uiDefinition": {
          "displayName": "Username",
          "description": "The username for Basic Auth",
          "tooltip": "Provide your username",
          "constraints": {
            "tabIndex": 3,
            "required": "false"
          },
          "dependsOn": [
            {
              "parameter": "auth_type",
              "value": "basic"
            }
          ]
        }
      },
      "password": {
        "type": "securestring",
        "uiDefinition": {
          "displayName": "Password",
          "description": "The password for Basic Auth",
          "tooltip": "Provide your password",
          "constraints": {
            "tabIndex": 4,
            "clearText": false,
            "required": "false"
          },
          "dependsOn": [
            {
              "parameter": "auth_type",
              "value": "basic"
            }
          ]
        }
      },
      "endpoint": {
        "type": "string",
        "uiDefinition": {
          "displayName": "Endpoint",
          "description": "The domain discovery endpoint to use (North America or EU)",
          "tooltip": "Select the domain discovery endpoint to use (North America or EU)",
          "constraints": {
            "tabIndex": 5,
            "required": "true",
            "allowedValues": [
              {
                "value": "api.us.socrata.com",
                "text": "North America"
              },
              {
                "value": "api.eu.socrata.com",
                "text": "EU"
              }
            ]
          }
        }
      }
    },
    "connectionParameterSets": {
      "uiDefinition": {
        "displayName": "Authentication Type",
        "description": "Choose the type of authentication to be used."
      },
      "values": [
        {
          "name": "basic-auth",
          "uiDefinition": {
            "displayName": "Use API Key",
            "description": "Log in using your API Key ID and API Key Secret. Optionally, include an App Token to avoid throttling by IP and achieve greater throughput."
          },
          "parameters": {
            "username": {
              "type": "string",
              "uiDefinition": {
                "displayName": "API Key ID",
                "schema": {
                  "description": "The API Key ID",
                  "type": "string"
                },
                "tooltip": "Enter your API Key ID",
                "constraints": {
                  "required": "true"
                }
              }
            },
            "password": {
              "type": "securestring",
              "uiDefinition": {
                "displayName": "API Key Secret",
                "schema": {
                  "description": "The API Key Secret",
                  "type": "securestring"
                },
                "tooltip": "Enter your API Key Secret",
                "constraints": {
                  "required": "true"
                }
              }
            },
            "app_token": {
              "type": "securestring",
              "uiDefinition": {
                "displayName": "App Token",
                "schema": {
                  "description": "The App Token for this API. This ensures requests are not throttled by IP, allowing greater throughput.",
                  "type": "securestring"
                },
                "tooltip": "Enter your App Token",
                "constraints": {
                  "required": "false"
                }
              }
            },
            "environment": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Endpoint",
                "schema": {
                  "description": "The domain discovery endpoint to use (North America or EU)",
                  "type": "string"
                },
                "tooltip": "Select the domain discovery endpoint to use (North America or EU)",
                "constraints": {
                  "required": "true",
                  "allowedValues": [
                    {
                      "value": "api.us.socrata.com",
                      "text": "North America"
                    },
                    {
                      "value": "api.eu.socrata.com",
                      "text": "EU"
                    }
                  ]
                }
              }
            }
          }
        },
        {
          "name": "api-auth",
          "uiDefinition": {
            "displayName": "Use App Token",
            "description": "Log in using your App Token. This ensures requests are not throttled by IP, allowing greater throughput."
          },
          "parameters": {
            "api_key": {
              "type": "securestring",
              "uiDefinition": {
                "constraints": {
                  "clearText": false,
                  "required": "true",
                  "tabIndex": 3
                },
                "schema": {
                  "description": "Enter your App Token",
                  "type": "securestring"
                },
                "displayName": "App Token"
              }
            },
            "environment": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Endpoint",
                "schema": {
                  "description": "The domain discovery endpoint to use (North America or EU)",
                  "type": "string"
                },
                "tooltip": "Select the domain discovery endpoint to use (North America or EU)",
                "constraints": {
                  "required": "true",
                  "allowedValues": [
                    {
                      "value": "api.us.socrata.com",
                      "text": "North America"
                    },
                    {
                      "value": "api.eu.socrata.com",
                      "text": "EU"
                    }
                  ]
                }
              }
            }
          }
        },
        {
          "name": "anonymous-auth",
          "uiDefinition": {
            "displayName": "Use Anonymously",
            "description": "Log in without authentication. Note: Without an App Token, you may encounter throttling issues."
          },
          "parameters": {
            "environment": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Endpoint",
                "schema": {
                  "description": "The domain discovery endpoint to use (North America or EU)",
                  "type": "string"
                },
                "tooltip": "Select the domain discovery endpoint to use (North America or EU)",
                "constraints": {
                  "required": "true",
                  "allowedValues": [
                    {
                      "value": "api.us.socrata.com",
                      "text": "North America"
                    },
                    {
                      "value": "api.eu.socrata.com",
                      "text": "EU"
                    }
                  ]
                }
              }
            }
          }
        }
      ]
    },
    "iconBrandColor": "#007ee5",
    "scriptOperations": [
      "SearchDataset",
      "GetAssetProperties",
      "GetSearchData",
      "SearchDatasetSoQL"
    ],
    "capabilities": [],
    "policyTemplateInstances": [
      {
        "templateId": "dynamichosturl",
        "title": "Use Endpoint",
        "parameters": {
          "x-ms-apimTemplateParameter.urlTemplate": "https://@connectionParameters('environment')/api",
          "x-ms-apimTemplate-operationName": [
            "CountByDomain"
          ]
        }
      }
    ],
    "publisher": "System Administrator",
    "stackOwner": "Tyler Technologies"
  }
}